<!DOCTYPE html>
<html>
    <head>
        <center><h1 id="text">Canvas</h1></center>
        <meta charset="utf-8"/>
    </head>
    <body>
        <center><canvas id="canvas" width="500" height="500" style="border:3px solid black;"></canvas></center>
        <script>

            var ctx, canvas;
            var edgeLength = 500;
            var rotationAngle = 0;
                                  //  x    y  rad  srad  tn   col
            var bigGear = new Gear  (150, 150, 130, 145, 50, 'green');
            var smallGear = new Gear(330, 270, 60, 75, 18, 'blue');

            function init() {
                canvas = document.getElementById("canvas");
                ctx = canvas.getContext("2d");
                return setInterval(drawGears, 25);
            }

            function drawGears(){

                ctx.clearRect(0, 0, edgeLength, edgeLength);
                ctx.save();
                ctx.save();
                ctx.translate(bigGear.xPos, bigGear.yPos);
                rotationAngle = rotationAngle + (Math.PI)/180;
                ctx.rotate(rotationAngle);
                bigGear.drawGear();

                ctx.restore();
                ctx.translate(smallGear.xPos, smallGear.yPos);
                ctx.rotate(-rotationAngle);
                smallGear.drawGear();
                ctx.restore();

                if(rotationAngle >= (Math.PI*2))
                    rotationAngle = 0;
            }

            function Gear(xPos, yPos, radius, teethRadius, teethNumber, color) {

                this.xPos = xPos;
                this.yPos = yPos;
                this.radius = radius;
                this.teethNumber = teethNumber;
                this.teethRadius = teethRadius;
                this.color = color;
                this.drawGear = function drawGear() {
                    var rSmall, rBig; // Skritulio ir dantens spinduliai
                    var x, y, spikeX, spikeY;
                    var incSmall = 360/this.teethNumber; // dantu inkrementai
                    var incBig = 360/this.teethNumber/2;

                    // Dantiracio skritulys
                    ctx.beginPath();
                    ctx.fillStyle = this.color;
                    ctx.arc(0, 0, this.radius, 0, Math.PI*2, true);
                    ctx.fill();

                    // Dantiracio vidurys
                    ctx.beginPath();
                    ctx.fillStyle = '#FFFFFF';
                    ctx.arc(0, 0, 10, 0, Math.PI * 2, true);
                    ctx.fill();
                    ctx.stroke();

                    ctx.fillStyle = this.color;
                    rSmall = rBig = 0;

                    // Dantu generavimas
                    for (i = 0; i < this.teethNumber; i++, rSmall+=incSmall) {

                        // Randamos trikampio kampo koordinates
                        x = this.radius*Math.cos(Math.PI*rSmall/180);
                        y = this.radius*Math.sin(Math.PI*rSmall/180);

                        // Randamos trikampio virsunes korrdinates
                        spikeX = this.teethRadius*Math.cos(Math.PI*(rSmall+incBig)/180);
                        spikeY = this.teethRadius*Math.sin(Math.PI*(rSmall+incBig)/180);

                        // Piesiamas trikampis
                        ctx.beginPath();
                        ctx.moveTo(x, y);
                        ctx.lineTo(spikeX, spikeY);
                        ctx.lineTo(this.radius*Math.cos(Math.PI*(rSmall+incSmall)/180), this.radius*Math.sin(Math.PI*(rSmall+incSmall)/180));
                        ctx.fill();
                        ctx.stroke();
                    }
                }
            }
            
            init();
        </script>
    </body>
</html>
