<!DOCTYPE html>
<html>
    <body>
        <center><canvas id="canvas2" width="500px" height="500px" style="border:3px solid black"></canvas></center>
        <div>
            <center>
                <p style="font-size:20px;"><b>Level</b></p>
                <button class="button" onclick="levelDown()" type="button"> < </button>
                <level id="level" class="bolden" style="font-size:25px; font-weight:bold">0</level>
                <button class="button" onclick="levelUp()" type="button"> > </button>
            </center>
        </div>
        <script>

        var canvas, ctx;
        var level = document.getElementById("level").innerHTML;

        function init() {
            canvas = document.getElementById('canvas2');
            if (canvas.getContext) {
                ctx = canvas.getContext('2d');
            }
        }

        function drawShape() {
            ctx.beginPath();
            ctx.moveTo(0,250);

            ctx.lineTo(0,320); ctx.lineTo(110,375); ctx.lineTo(0,375); ctx.lineTo(0,500);
            ctx.lineTo(155,440); ctx.lineTo(190,375); ctx.lineTo(370,375); ctx.lineTo(250,440);
            ctx.lineTo(250,500); ctx.lineTo(375,500); ctx.lineTo(375,440); ctx.lineTo(500,500);
            ctx.lineTo(500,370); ctx.lineTo(440,370); ctx.lineTo(400,315); ctx.lineTo(330,280);
            ctx.lineTo(250,250); ctx.lineTo(420,180); ctx.lineTo(375,250); ctx.lineTo(500,250);
            ctx.lineTo(500,180); ctx.lineTo(390,125); ctx.lineTo(500,125); ctx.lineTo(500,0);
            ctx.lineTo(340,60); ctx.lineTo(310,125); ctx.lineTo(190,125); ctx.lineTo(125,250);
            ctx.lineTo(0,250);

            ctx.fill();
        }

        function fractalize(level) {
            if (level>0) {

                level = level - 1;
                ctx.save();
                ctx.save();
                ctx.save();

                ctx.transform(-0.25, 0, 0, 0.25, canvas.width/4, canvas.height/4);
                ctx.rotate(Math.PI/2);
                fractalize(level);
                ctx.restore();

                ctx.transform(0.5, 0, 0, 0.5, canvas.width/2, 0);
                fractalize(level);
                ctx.restore();

                ctx.transform(-0.5, 0, 0, 0.5, canvas.width, canvas.width/2);
                fractalize(level);
                ctx.restore();

                ctx.transform(-0.5, 0, 0, -0.5, canvas.width/2, canvas.width);
                fractalize(level);
            }

            else
                drawShape();
        }

        function animate(quarter) {
            var a, d, e, f;
            var currentTransform = {
                a : 1,
                d : 1,
                e : 0,
                f : 0,
            };
            switch (quarter) {
                case 1:
                    a = -0.25;
                    d = 0.25;
                    e = canvas.width/4;
                    f = canvas.height/4
                    break;
                case 2:
                    a = d = 0.5;
                    e = 250; // 250px
                    break;
                case 3:
                    a = -0.5;
                    d = 0.5;
                    e = canvas.width;
                    f = canvas.height/2;
                    break;
                case 4:
                    a = c = -0.5
                    e = canvas.width/2;
                    f = canvas.width;
                    break;
            }
            var scaleInt = 0.1
            var MoveInt = 50;
            var moveNull = 0;
            var moveMeh = 1;
            var fps = 15;
            var frame;

            function draw() {
                setTimeout(function() {
                    frame = requestAnimationFrame(draw);
                    currentTransform.a -= 0.1;
                    currentTransform.d -= 0.1;
                    currentTransform.e += 50;
                    a = currentTransform.a;
                    d = currentTransform.d;
                    e = currentTransform.e;
                       if (a <= 0.55)
                            cancelAnimationFrame(frame);
                       if (a => 0.5) {
                           ctx.clearRect(0,0,500,500);
                           ctx.save();
                           ctx.transform(a, 0, 0, d, e, 0);
                           drawShape();
                           ctx.restore();
                        }

                }, 1000/fps);

            }
            draw();

        }

        function levelDown() {
            if (level == 0)
                return
            else {
                ctx.save();
                level --;
                ctx.setTransform(1,0,0,1,0,0);
                ctx.clearRect(0,0,canvas.width, canvas.height);
                document.getElementById('level').innerHTML = level;
                ctx.clearRect(0,0,500,500);
                fractalize(level);
                ctx.restore();
            }
        }

        function levelUp() {
            if (level == 6)
                return
            else {
                ctx.save();
                level ++;
                ctx.setTransform(1,0,0,1,0,0);
                document.getElementById("level").innerHTML = level;
                ctx.clearRect(0,0,canvas.height, canvas.width);
                fractalize(level);
                ctx.restore();
            }
        }

        init();
        animate(2);
        //fractalize(level);

        </script>
    </body>
</html>

<style>
    .bolden {
        font-weight:bold;
        font-size: 28;
        text-decoration:none;
    }

    .button {
        display: inline-block;
        padding: 2px 8px;
        font-size: 24px;
        cursor: pointer;
        text-align: center;
        text-decoration: none;
        outline: none;
        color: #fff;
        background-color: #4CAF50;
        border: none;
        border-radius: 15px;
    }

    .button:hover {background-color: #3e8e41}

    .button:active {
        box-shadow: 0 1px #666;
        transform: translateY(4px);
    }
</style>
